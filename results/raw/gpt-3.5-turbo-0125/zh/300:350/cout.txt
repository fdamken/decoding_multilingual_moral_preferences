INFO - tinypaper - Running command 'main'
INFO - tinypaper - Started run with ID "149"
/Users/karina/Documents/Coding/PyCharm/mme/src/model/model.py:19: UserWarning: Running model NOT in dry mode! This will consume API tokens and may cost money. MAKE SURE TO RUN IN DRY MODE FIRST TO GET AN ESTIMATE!
  warnings.warn(
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:10<08:28, 10.38s/it]  4%|▍         | 2/50 [00:19<07:35,  9.48s/it]  6%|▌         | 3/50 [00:28<07:11,  9.18s/it]  8%|▊         | 4/50 [00:36<06:57,  9.08s/it] 10%|█         | 5/50 [00:45<06:42,  8.94s/it] 12%|█▏        | 6/50 [00:53<06:15,  8.54s/it] 14%|█▍        | 7/50 [01:01<06:01,  8.41s/it] 16%|█▌        | 8/50 [01:09<05:51,  8.37s/it] 18%|█▊        | 9/50 [01:18<05:40,  8.31s/it] 20%|██        | 10/50 [01:26<05:40,  8.50s/it] 22%|██▏       | 11/50 [01:38<06:02,  9.31s/it] 24%|██▍       | 12/50 [01:45<05:30,  8.71s/it] 26%|██▌       | 13/50 [01:53<05:10,  8.38s/it]WARNING - root - Finished call to 'agent.Agent.play' after 0.862(s), this was the 1st time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 请.
 28%|██▊       | 14/50 [02:01<05:01,  8.37s/it]WARNING - root - Finished call to 'agent.Agent.play' after 6.846(s), this was the 1st time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 这.
WARNING - root - Finished call to 'agent.Agent.play' after 14.148(s), this was the 2nd time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 这.
WARNING - root - Finished call to 'agent.Agent.play' after 21.732(s), this was the 3rd time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 这.
WARNING - root - Finished call to 'agent.Agent.play' after 29.372(s), this was the 4th time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 这.
WARNING - root - Finished call to 'agent.Agent.play' after 36.738(s), this was the 5th time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 这.
WARNING - root - Finished call to 'agent.Agent.play' after 44.693(s), this was the 6th time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 这.
WARNING - root - Finished call to 'agent.Agent.play' after 51.443(s), this was the 7th time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 这.
WARNING - root - Finished call to 'agent.Agent.play' after 58.813(s), this was the 8th time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 这.
WARNING - root - Finished call to 'agent.Agent.play' after 65.736(s), this was the 9th time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 这.
WARNING - root - Finished call to 'agent.Agent.play' after 73.263(s), this was the 10th time calling it.
Traceback (most recent call last):
  File "/Users/karina/opt/anaconda3/envs/LLMs/lib/python3.11/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/Users/karina/Documents/Coding/PyCharm/mme/src/agent.py", line 26, in play
    answer = self._prompt(self._make_prompt(scenario))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/karina/Documents/Coding/PyCharm/mme/src/agent.py", line 40, in _prompt
    raise UnexpectedAnswerException(f"expected 1 or 2, got {result}")
util.UnexpectedAnswerException: expected 1 or 2, got 这

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/karina/Documents/Coding/PyCharm/mme/scripts/experiments/run.py", line 16, in _run_session
    result = agent.play(session)
             ^^^^^^^^^^^^^^^^^^^
  File "/Users/karina/opt/anaconda3/envs/LLMs/lib/python3.11/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/karina/opt/anaconda3/envs/LLMs/lib/python3.11/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/karina/opt/anaconda3/envs/LLMs/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x1391aabd0 state=finished raised UnexpectedAnswerException>]
 30%|███       | 15/50 [03:14<16:17, 27.93s/it] 32%|███▏      | 16/50 [03:22<12:22, 21.84s/it] 34%|███▍      | 17/50 [03:30<09:43, 17.69s/it] 36%|███▌      | 18/50 [03:38<07:51, 14.73s/it] 38%|███▊      | 19/50 [03:46<06:34, 12.73s/it] 40%|████      | 20/50 [03:54<05:38, 11.29s/it] 42%|████▏     | 21/50 [04:04<05:19, 11.01s/it] 44%|████▍     | 22/50 [04:12<04:43, 10.12s/it] 46%|████▌     | 23/50 [04:20<04:13,  9.38s/it] 48%|████▊     | 24/50 [04:27<03:49,  8.84s/it] 50%|█████     | 25/50 [04:36<03:41,  8.86s/it] 52%|█████▏    | 26/50 [04:44<03:21,  8.41s/it] 54%|█████▍    | 27/50 [04:51<03:08,  8.20s/it] 56%|█████▌    | 28/50 [05:00<03:04,  8.38s/it] 58%|█████▊    | 29/50 [05:10<03:04,  8.79s/it] 60%|██████    | 30/50 [05:18<02:52,  8.60s/it] 62%|██████▏   | 31/50 [05:28<02:48,  8.88s/it] 64%|██████▍   | 32/50 [05:36<02:38,  8.78s/it] 66%|██████▌   | 33/50 [05:44<02:22,  8.41s/it] 68%|██████▊   | 34/50 [05:52<02:13,  8.34s/it] 70%|███████   | 35/50 [06:02<02:12,  8.81s/it] 72%|███████▏  | 36/50 [06:10<02:00,  8.59s/it] 74%|███████▍  | 37/50 [06:18<01:49,  8.42s/it] 76%|███████▌  | 38/50 [06:26<01:41,  8.47s/it] 78%|███████▊  | 39/50 [06:36<01:37,  8.87s/it] 80%|████████  | 40/50 [06:46<01:31,  9.14s/it] 82%|████████▏ | 41/50 [06:55<01:21,  9.02s/it] 84%|████████▍ | 42/50 [07:03<01:11,  8.91s/it] 86%|████████▌ | 43/50 [07:12<01:01,  8.82s/it] 88%|████████▊ | 44/50 [07:20<00:50,  8.49s/it] 90%|█████████ | 45/50 [07:28<00:42,  8.43s/it] 92%|█████████▏| 46/50 [07:36<00:32,  8.19s/it] 94%|█████████▍| 47/50 [07:44<00:24,  8.15s/it] 96%|█████████▌| 48/50 [07:52<00:16,  8.11s/it] 98%|█████████▊| 49/50 [08:00<00:08,  8.17s/it]100%|██████████| 50/50 [08:08<00:00,  8.20s/it]100%|██████████| 50/50 [08:08<00:00,  9.78s/it]
INFO - tinypaper - Result: {'answers': [[2, 1, 2, 2, 2, 2, 2, 2, 1, 1, 1, 2, 2], [2, 2, 2, 1, 2, 1, 2, 2, 1, 1, 2, 1, 2], [2, 2, 2, 1, 1, 2, 2, 1, 2, 2, 1, 2, 2], [2, 2, 1, 1, 2, 2, 1, 1, 2, 2, 2, 1, 2], [2, 2, 2, 2, 2, 2, 1, 2, 1, 1, 2, 2, 2], [2, 1, 1, 1, 1, 2, 2, 2, 1, 2, 2, 2, 2], [2, 1, 1, 2, 1, 2, 2, 1, 1, 2, 2, 2, 1], [1, 2, 1, 1, 1, 2, 2, 2, 2, 1, 1, 2, 2], [1, 2, 1, 1, 1, 1, 2, 1, 1, 2, 2, 2, 1], [2, 2, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 2], [1, 1, 1, 2, 1, 1, 1, 2, 2, 2, 1, 2, 2], [1, 1, 2, 2, 2, 2, 1, 1, 2, 2, 2, 1, 2], [2, 2, 1, 1, 2, 2, 2, 1, 1, 2, 2, 2, 2], [2, 2, 2, 1, 2, 1, 1, 2, 2, 1, 1, 2, 1], 'Traceback (most recent call last):\n  File "/Users/karina/opt/anaconda3/envs/LLMs/lib/python3.11/site-packages/tenacity/__init__.py", line 382, in __call__\n    result = fn(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^\n  File "/Users/karina/Documents/Coding/PyCharm/mme/src/agent.py", line 26, in play\n    answer = self._prompt(self._make_prompt(scenario))\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/Users/karina/Documents/Coding/PyCharm/mme/src/agent.py", line 40, in _prompt\n    raise UnexpectedAnswerException(f"expected 1 or 2, got {result}")\nutil.UnexpectedAnswerException: expected 1 or 2, got 这\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/Users/karina/Documents/Coding/PyCharm/mme/scripts/experiments/run.py", line 16, in _run_session\n    result = agent.play(session)\n             ^^^^^^^^^^^^^^^^^^^\n  File "/Users/karina/opt/anaconda3/envs/LLMs/lib/python3.11/site-packages/tenacity/__init__.py", line 289, in wrapped_f\n    return self(f, *args, **kw)\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/Users/karina/opt/anaconda3/envs/LLMs/lib/python3.11/site-packages/tenacity/__init__.py", line 379, in __call__\n    do = self.iter(retry_state=retry_state)\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/Users/karina/opt/anaconda3/envs/LLMs/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter\n    raise retry_exc from fut.exception()\ntenacity.RetryError: RetryError[<Future at 0x1391aabd0 state=finished raised UnexpectedAnswerException>]\n', [1, 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 1, 2], [1, 1, 1, 2, 2, 2, 2, 1, 1, 1, 2, 2, 1], [2, 1, 2, 2, 2, 2, 1, 2, 2, 2, 1, 2, 2], [2, 1, 2, 2, 2, 1, 2, 2, 2, 1, 2, 2, 2], [2, 1, 1, 1, 2, 1, 1, 2, 1, 1, 2, 2, 1], [2, 1, 2, 1, 1, 1, 1, 2, 1, 1, 2, 2, 2], [2, 2, 1, 2, 2, 1, 2, 1, 1, 2, 2, 2, 2], [2, 1, 1, 1, 2, 1, 2, 1, 2, 1, 1, 2, 2], [1, 1, 2, 1, 2, 2, 2, 2, 1, 2, 1, 2, 2], [1, 2, 2, 1, 2, 1, 2, 2, 2, 2, 1, 1, 1], [1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 2], [1, 1, 1, 2, 2, 2, 1, 1, 2, 2, 2, 2, 2], [2, 1, 2, 1, 1, 1, 2, 2, 1, 2, 1, 2, 2], [1, 1, 2, 1, 1, 2, 2, 2, 2, 2, 2, 1, 1], [1, 1, 1, 2, 2, 2, 1, 2, 1, 1, 2, 2, 1], [2, 2, 2, 1, 2, 2, 1, 1, 1, 1, 2, 2, 1], [2, 2, 2, 2, 2, 2, 2, 1, 1, 2, 2, 1, 2], [2, 2, 2, 2, 1, 2, 2, 2, 1, 2, 1, 2, 1], [1, 1, 2, 2, 2, 2, 2, 1, 1, 2, 1, 2, 2], [1, 1, 1, 2, 2, 2, 1, 1, 2, 1, 2, 1, 1], [1, 2, 2, 1, 2, 2, 2, 2, 2, 1, 1, 1, 2], [2, 2, 1, 1, 1, 1, 1, 2, 1, 2, 2, 2, 1], [2, 1, 2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 1], [1, 1, 2, 2, 2, 1, 1, 2, 2, 1, 2, 1, 1], [2, 2, 2, 2, 2, 1, 1, 1, 1, 2, 1, 2, 1], [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 1], [2, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2], [2, 1, 2, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2], [1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 1], [1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 2, 2, 2], [1, 2, 2, 1, 1, 1, 2, 2, 1, 1, 1, 1, 2], [2, 2, 1, 2, 2, 2, 2, 1, 1, 2, 2, 1, 1], [2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 2, 2], [2, 2, 1, 2, 2, 1, 2, 2, 1, 1, 2, 2, 1], [1, 1, 1, 2, 2, 1, 2, 2, 2, 2, 1, 2, 2]], 'api_usage': [APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=19611, num_output_tokens=13, cost=0.009825), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=37556, num_output_tokens=26, cost=0.018817), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=55886, num_output_tokens=39, cost=0.0280015), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=74157, num_output_tokens=52, cost=0.0371565), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=93277, num_output_tokens=65, cost=0.046736), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=112776, num_output_tokens=78, cost=0.056505), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=130910, num_output_tokens=91, cost=0.0655915), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=151252, num_output_tokens=104, cost=0.075782), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=169284, num_output_tokens=117, cost=0.0848175), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=186949, num_output_tokens=130, cost=0.0936695), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=206849, num_output_tokens=143, cost=0.103639), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=226846, num_output_tokens=156, cost=0.113657), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=244789, num_output_tokens=169, cost=0.122648), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=263072, num_output_tokens=183, cost=0.1318105), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=416722, num_output_tokens=303, cost=0.2088155), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=435283, num_output_tokens=316, cost=0.2181155), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=454229, num_output_tokens=329, cost=0.227608), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=472648, num_output_tokens=342, cost=0.236837), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=490970, num_output_tokens=355, cost=0.2460175), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=508771, num_output_tokens=368, cost=0.2549375), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=528305, num_output_tokens=381, cost=0.264724), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=545365, num_output_tokens=394, cost=0.2732735), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=563305, num_output_tokens=407, cost=0.282263), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=581877, num_output_tokens=420, cost=0.2915685), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=600761, num_output_tokens=433, cost=0.30103), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=618450, num_output_tokens=446, cost=0.309894), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=638056, num_output_tokens=459, cost=0.3197165), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=657768, num_output_tokens=472, cost=0.329592), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=676912, num_output_tokens=485, cost=0.3391835), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=694970, num_output_tokens=498, cost=0.348232), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=716025, num_output_tokens=511, cost=0.358779), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=736254, num_output_tokens=524, cost=0.368913), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=754568, num_output_tokens=537, cost=0.3780895), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=771666, num_output_tokens=550, cost=0.386658), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=788606, num_output_tokens=563, cost=0.3951475), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=808409, num_output_tokens=576, cost=0.4050685), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=828733, num_output_tokens=589, cost=0.41525), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=849127, num_output_tokens=602, cost=0.4254665), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=868222, num_output_tokens=615, cost=0.4350335), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=886587, num_output_tokens=628, cost=0.4442355), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=906729, num_output_tokens=641, cost=0.454326), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=926752, num_output_tokens=654, cost=0.464357), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=944677, num_output_tokens=667, cost=0.473339), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=962559, num_output_tokens=680, cost=0.4822995), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=979329, num_output_tokens=693, cost=0.490704), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=998085, num_output_tokens=706, cost=0.5001015), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=1015673, num_output_tokens=719, cost=0.508915), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=1032715, num_output_tokens=732, cost=0.5174555), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=1051502, num_output_tokens=745, cost=0.5268685), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=1070741, num_output_tokens=758, cost=0.5365075)], 'api_usage_total': APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=28754565, num_output_tokens=20464, cost=14.407978499999997)}
INFO - tinypaper - Completed after 0:08:09
