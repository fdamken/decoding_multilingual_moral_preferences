INFO - tinypaper - Running command 'main'
INFO - tinypaper - Started run with ID "98"
/Users/karina/Documents/Coding/PyCharm/mme/src/model/model.py:19: UserWarning: Running model NOT in dry mode! This will consume API tokens and may cost money. MAKE SURE TO RUN IN DRY MODE FIRST TO GET AN ESTIMATE!
  warnings.warn(
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:09<07:27,  9.14s/it]  4%|▍         | 2/50 [00:18<07:28,  9.34s/it]  6%|▌         | 3/50 [00:31<08:29, 10.83s/it]  8%|▊         | 4/50 [00:40<07:51, 10.24s/it] 10%|█         | 5/50 [00:50<07:38, 10.18s/it] 12%|█▏        | 6/50 [00:58<06:54,  9.41s/it] 14%|█▍        | 7/50 [01:07<06:42,  9.37s/it] 16%|█▌        | 8/50 [01:17<06:38,  9.50s/it] 18%|█▊        | 9/50 [01:27<06:40,  9.77s/it] 20%|██        | 10/50 [01:37<06:25,  9.63s/it] 22%|██▏       | 11/50 [01:47<06:19,  9.74s/it] 24%|██▍       | 12/50 [01:57<06:17,  9.94s/it] 26%|██▌       | 13/50 [02:11<06:50, 11.10s/it] 28%|██▊       | 14/50 [02:21<06:29, 10.83s/it] 30%|███       | 15/50 [02:30<05:59, 10.28s/it] 32%|███▏      | 16/50 [02:40<05:46, 10.20s/it] 34%|███▍      | 17/50 [02:49<05:23,  9.79s/it] 36%|███▌      | 18/50 [02:59<05:10,  9.71s/it] 38%|███▊      | 19/50 [03:07<04:52,  9.44s/it] 40%|████      | 20/50 [03:18<04:57,  9.92s/it] 42%|████▏     | 21/50 [03:30<04:58, 10.31s/it] 44%|████▍     | 22/50 [03:45<05:33, 11.89s/it]WARNING - root - Finished call to 'agent.Agent.play' after 7.019(s), this was the 1st time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 어.
 46%|████▌     | 23/50 [04:02<05:58, 13.28s/it]WARNING - root - Finished call to 'agent.Agent.play' after 1.019(s), this was the 1st time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 어.
 48%|████▊     | 24/50 [04:11<05:14, 12.08s/it] 50%|█████     | 25/50 [04:20<04:36, 11.08s/it] 52%|█████▏    | 26/50 [04:28<04:04, 10.20s/it]WARNING - root - Finished call to 'agent.Agent.play' after 1.249(s), this was the 1st time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 어.
WARNING - root - Finished call to 'agent.Agent.play' after 2.304(s), this was the 2nd time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 어.
WARNING - root - Finished call to 'agent.Agent.play' after 3.140(s), this was the 3rd time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 어.
WARNING - root - Finished call to 'agent.Agent.play' after 4.217(s), this was the 4th time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 어.
WARNING - root - Finished call to 'agent.Agent.play' after 5.080(s), this was the 5th time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 어.
WARNING - root - Finished call to 'agent.Agent.play' after 6.176(s), this was the 6th time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 어.
WARNING - root - Finished call to 'agent.Agent.play' after 7.193(s), this was the 7th time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 어.
WARNING - root - Finished call to 'agent.Agent.play' after 8.187(s), this was the 8th time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 어.
WARNING - root - Finished call to 'agent.Agent.play' after 9.110(s), this was the 9th time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 어.
WARNING - root - Finished call to 'agent.Agent.play' after 10.045(s), this was the 10th time calling it.
Traceback (most recent call last):
  File "/Users/karina/opt/anaconda3/envs/LLMs/lib/python3.11/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/Users/karina/Documents/Coding/PyCharm/mme/src/agent.py", line 26, in play
    answer = self._prompt(self._make_prompt(scenario))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/karina/Documents/Coding/PyCharm/mme/src/agent.py", line 40, in _prompt
    raise UnexpectedAnswerException(f"expected 1 or 2, got {result}")
util.UnexpectedAnswerException: expected 1 or 2, got 어

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/karina/Documents/Coding/PyCharm/mme/scripts/experiments/run.py", line 16, in _run_session
    result = agent.play(session)
             ^^^^^^^^^^^^^^^^^^^
  File "/Users/karina/opt/anaconda3/envs/LLMs/lib/python3.11/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/karina/opt/anaconda3/envs/LLMs/lib/python3.11/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/karina/opt/anaconda3/envs/LLMs/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x13ca634d0 state=finished raised UnexpectedAnswerException>]
 54%|█████▍    | 27/50 [04:38<03:53, 10.15s/it]WARNING - root - Finished call to 'agent.Agent.play' after 0.828(s), this was the 1st time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 어.
 56%|█████▌    | 28/50 [04:47<03:36,  9.86s/it] 58%|█████▊    | 29/50 [04:56<03:22,  9.64s/it] 60%|██████    | 30/50 [05:05<03:05,  9.30s/it] 62%|██████▏   | 31/50 [05:16<03:09,  9.96s/it] 64%|██████▍   | 32/50 [05:26<02:55,  9.75s/it] 66%|██████▌   | 33/50 [05:37<02:53, 10.20s/it] 68%|██████▊   | 34/50 [05:46<02:38,  9.91s/it] 70%|███████   | 35/50 [05:57<02:35, 10.34s/it] 72%|███████▏  | 36/50 [06:09<02:30, 10.73s/it] 74%|███████▍  | 37/50 [06:17<02:10, 10.05s/it] 76%|███████▌  | 38/50 [06:28<02:01, 10.09s/it] 78%|███████▊  | 39/50 [06:36<01:45,  9.57s/it] 80%|████████  | 40/50 [06:44<01:31,  9.16s/it] 82%|████████▏ | 41/50 [06:52<01:19,  8.81s/it] 84%|████████▍ | 42/50 [07:01<01:10,  8.78s/it] 86%|████████▌ | 43/50 [07:11<01:04,  9.17s/it] 88%|████████▊ | 44/50 [07:20<00:55,  9.20s/it] 90%|█████████ | 45/50 [07:29<00:44,  8.93s/it]WARNING - root - Finished call to 'agent.Agent.play' after 0.801(s), this was the 1st time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 어.
WARNING - root - Finished call to 'agent.Agent.play' after 1.718(s), this was the 2nd time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 어.
WARNING - root - Finished call to 'agent.Agent.play' after 2.774(s), this was the 3rd time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 어.
WARNING - root - Finished call to 'agent.Agent.play' after 3.753(s), this was the 4th time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 어.
WARNING - root - Finished call to 'agent.Agent.play' after 4.808(s), this was the 5th time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 어.
 92%|█████████▏| 46/50 [07:42<00:40, 10.17s/it] 94%|█████████▍| 47/50 [07:51<00:29,  9.83s/it]WARNING - root - Finished call to 'agent.Agent.play' after 0.878(s), this was the 1st time calling it.
INFO - root - Retrying agent.Agent.play in 0.0 seconds as it raised UnexpectedAnswerException: expected 1 or 2, got 어.
 96%|█████████▌| 48/50 [08:00<00:19,  9.77s/it] 98%|█████████▊| 49/50 [08:10<00:09,  9.65s/it]100%|██████████| 50/50 [08:21<00:00, 10.14s/it]100%|██████████| 50/50 [08:21<00:00, 10.03s/it]
INFO - tinypaper - Result: {'answers': [[1, 2, 2, 1, 2, 2, 2, 1, 1, 1, 1, 1, 1], [2, 2, 2, 1, 1, 1, 2, 1, 1, 1, 2, 1, 2], [2, 1, 1, 1, 1, 2, 1, 1, 2, 2, 1, 2, 2], [2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 1, 1, 2], [2, 1, 2, 2, 1, 1, 2, 2, 1, 2, 2, 2, 1], [2, 2, 1, 2, 2, 1, 2, 2, 1, 1, 2, 2, 2], [1, 1, 1, 1, 2, 1, 2, 2, 2, 1, 1, 1, 1], [2, 2, 1, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], [1, 1, 2, 2, 2, 2, 2, 1, 1, 1, 1, 2, 2], [1, 1, 1, 1, 1, 2, 2, 1, 1, 2, 2, 1, 1], [2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 1, 1, 2], [2, 2, 2, 1, 2, 1, 2, 2, 1, 1, 2, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2], [2, 2, 2, 2, 2, 2, 1, 2, 1, 1, 2, 1, 2], [1, 1, 2, 1, 2, 1, 2, 2, 2, 2, 1, 1, 1], [1, 2, 1, 1, 2, 2, 1, 1, 1, 2, 2, 1, 2], [2, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 2, 2], [1, 2, 1, 1, 1, 1, 1, 2, 1, 2, 2, 1, 2], [1, 1, 1, 2, 2, 2, 2, 2, 1, 2, 2, 2, 1], [1, 1, 1, 1, 2, 1, 2, 1, 1, 2, 1, 2, 2], [1, 1, 2, 1, 2, 2, 1, 2, 1, 1, 1, 2, 2], [1, 2, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1], [1, 1, 2, 1, 1, 2, 2, 2, 2, 1, 2, 1, 1], [2, 2, 1, 2, 1, 1, 2, 2, 1, 2, 1, 2, 2], [2, 1, 1, 2, 2, 1, 1, 2, 2, 2, 1, 2, 2], [2, 1, 1, 2, 2, 1, 2, 2, 2, 2, 1, 1, 2], 'Traceback (most recent call last):\n  File "/Users/karina/opt/anaconda3/envs/LLMs/lib/python3.11/site-packages/tenacity/__init__.py", line 382, in __call__\n    result = fn(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^\n  File "/Users/karina/Documents/Coding/PyCharm/mme/src/agent.py", line 26, in play\n    answer = self._prompt(self._make_prompt(scenario))\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/Users/karina/Documents/Coding/PyCharm/mme/src/agent.py", line 40, in _prompt\n    raise UnexpectedAnswerException(f"expected 1 or 2, got {result}")\nutil.UnexpectedAnswerException: expected 1 or 2, got 어\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/Users/karina/Documents/Coding/PyCharm/mme/scripts/experiments/run.py", line 16, in _run_session\n    result = agent.play(session)\n             ^^^^^^^^^^^^^^^^^^^\n  File "/Users/karina/opt/anaconda3/envs/LLMs/lib/python3.11/site-packages/tenacity/__init__.py", line 289, in wrapped_f\n    return self(f, *args, **kw)\n           ^^^^^^^^^^^^^^^^^^^^\n  File "/Users/karina/opt/anaconda3/envs/LLMs/lib/python3.11/site-packages/tenacity/__init__.py", line 379, in __call__\n    do = self.iter(retry_state=retry_state)\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/Users/karina/opt/anaconda3/envs/LLMs/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter\n    raise retry_exc from fut.exception()\ntenacity.RetryError: RetryError[<Future at 0x13ca634d0 state=finished raised UnexpectedAnswerException>]\n', [1, 2, 2, 2, 1, 1, 1, 1, 1, 2, 2, 2, 1], [2, 1, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1], [2, 2, 1, 1, 1, 2, 1, 2, 2, 2, 2, 1, 1], [2, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 2, 1], [1, 2, 1, 2, 2, 2, 2, 2, 1, 1, 1, 1, 2], [2, 1, 1, 1, 2, 1, 2, 2, 2, 2, 1, 2, 1], [1, 1, 1, 2, 2, 1, 2, 2, 2, 2, 2, 1, 1], [2, 1, 1, 2, 2, 1, 1, 2, 2, 1, 2, 2, 2], [2, 1, 1, 2, 2, 2, 2, 2, 1, 1, 2, 2, 2], [1, 2, 1, 1, 2, 1, 1, 2, 1, 1, 1, 1, 2], [1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 2, 1, 2, 2, 1, 2, 2, 2, 1, 2, 1, 1], [1, 1, 1, 1, 2, 1, 2, 1, 2, 2, 2, 1, 1], [2, 1, 2, 1, 1, 2, 2, 2, 1, 1, 2, 2, 2], [2, 2, 1, 1, 1, 2, 2, 1, 1, 1, 2, 2, 1], [2, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 2, 2], [2, 2, 1, 1, 2, 1, 1, 1, 1, 2, 2, 1, 1], [2, 1, 1, 2, 1, 1, 2, 1, 1, 1, 2, 1, 2], [1, 1, 2, 1, 2, 1, 2, 2, 2, 2, 1, 1, 1], [1, 1, 1, 1, 2, 2, 2, 1, 2, 1, 1, 2, 1], [1, 1, 2, 2, 1, 1, 2, 1, 1, 2, 2, 2, 2], [1, 2, 2, 1, 1, 2, 2, 1, 1, 1, 2, 2, 2], [1, 2, 2, 2, 2, 2, 2, 1, 1, 2, 2, 2, 2]], 'api_usage': [APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=21331, num_output_tokens=13, cost=0.010685), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=41946, num_output_tokens=26, cost=0.021012), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=61551, num_output_tokens=39, cost=0.030834), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=83154, num_output_tokens=52, cost=0.041655), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=103442, num_output_tokens=65, cost=0.0518185), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=124909, num_output_tokens=78, cost=0.0625715), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=145617, num_output_tokens=91, cost=0.072945), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=166247, num_output_tokens=104, cost=0.0832795), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=186811, num_output_tokens=117, cost=0.093581), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=206230, num_output_tokens=130, cost=0.10331), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=225374, num_output_tokens=143, cost=0.1129015), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=247061, num_output_tokens=156, cost=0.1237645), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=267841, num_output_tokens=169, cost=0.134174), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=288469, num_output_tokens=182, cost=0.1445075), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=309860, num_output_tokens=195, cost=0.1552225), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=329924, num_output_tokens=208, cost=0.165274), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=350329, num_output_tokens=221, cost=0.175496), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=372374, num_output_tokens=234, cost=0.186538), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=391808, num_output_tokens=247, cost=0.1962745), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=412283, num_output_tokens=260, cost=0.2065315), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=433941, num_output_tokens=273, cost=0.21738), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=455880, num_output_tokens=286, cost=0.228369), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=478465, num_output_tokens=300, cost=0.2396825), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=498775, num_output_tokens=314, cost=0.2498585), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=517164, num_output_tokens=327, cost=0.2590725), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=537087, num_output_tokens=340, cost=0.2690535), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=540707, num_output_tokens=350, cost=0.2708785), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=561676, num_output_tokens=364, cost=0.281384), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=581011, num_output_tokens=377, cost=0.291071), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=601310, num_output_tokens=390, cost=0.30124), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=621616, num_output_tokens=403, cost=0.3114125), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=641918, num_output_tokens=416, cost=0.321583), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=662853, num_output_tokens=429, cost=0.33207), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=684312, num_output_tokens=442, cost=0.342819), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=706546, num_output_tokens=455, cost=0.3539555), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=729114, num_output_tokens=468, cost=0.365259), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=748264, num_output_tokens=481, cost=0.3748535), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=768143, num_output_tokens=494, cost=0.3848125), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=788822, num_output_tokens=507, cost=0.3951715), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=811202, num_output_tokens=520, cost=0.406381), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=832662, num_output_tokens=533, cost=0.4171305), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=852663, num_output_tokens=546, cost=0.4271505), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=872323, num_output_tokens=559, cost=0.437), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=892082, num_output_tokens=572, cost=0.446899), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=913341, num_output_tokens=585, cost=0.457548), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=937522, num_output_tokens=603, cost=0.4696655), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=957264, num_output_tokens=616, cost=0.479556), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=978322, num_output_tokens=630, cost=0.490106), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=998952, num_output_tokens=643, cost=0.5004405), APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=1019028, num_output_tokens=656, cost=0.510498)], 'api_usage_total': APIUsage(name='gpt-3.5-turbo-0125', num_input_tokens=25959526, num_output_tokens=16609, cost=13.0046765)}
INFO - tinypaper - Completed after 0:08:22
